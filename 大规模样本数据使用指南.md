# 大规模样本数据使用指南

## 📊 功能概述

已成功实现大规模样本数据生成功能，用于客户缺货管理系统的功能测试和性能验证。

### 数据规模
- **客户数量**: 500个（重要客户100 + 标准客户200 + 普通客户200）
- **产品数量**: 300个（上衣100 + 裤装80 + 裙装60 + 鞋类40 + 配饰20）
- **欠货记录**: 20000条（分布在2025年1-8月）

## 🚀 启用方法

### 方法1：Xcode环境变量设置
1. 在Xcode中选择 `Product` → `Scheme` → `Edit Scheme`
2. 选择左侧的 `Run`
3. 点击 `Arguments` 标签页
4. 在 `Environment Variables` 部分添加：
   - **Name**: `LARGE_SAMPLE_DATA`
   - **Value**: `true`
5. 点击 `Close` 保存设置

### 方法2：Launch Arguments（推荐）
在 `Arguments Passed On Launch` 中添加：
```
-LARGE_SAMPLE_DATA YES
```

## 📱 运行测试

### 启动应用
1. 确保环境变量已设置
2. 选择iOS模拟器（推荐iPhone 16）
3. 运行应用（⌘+R）

### 观察生成过程
应用启动后将自动检测环境变量并开始生成数据：

```
🚀 检测到大规模样本数据环境变量，开始生成大规模测试数据...
📊 目标：500个客户，300个产品，20000条欠货记录

📋 阶段1：生成客户数据...
  生成重要客户 100 个...
  生成标准客户 200 个...
  生成普通客户 200 个...
✅ 成功生成 500 个客户

📦 阶段2：生成产品数据...
  生成上衣类 100 个...
  生成裤装类 80 个...
  ...
✅ 成功生成 300 个产品

📝 阶段3：生成欠货记录...
    生成1月记录：1500 条
    生成2月记录：800 条
    ...
```

### 预期耗时
- **总时间**: 3-5分钟
- **客户数据**: ~15秒
- **产品数据**: ~10秒  
- **欠货记录**: ~2-3分钟

## 🧪 功能测试建议

### 1. 基础功能测试
- ✅ 进入"客户缺货管理"页面
- ✅ 验证数据加载（应显示大量数据）
- ✅ 测试列表滚动性能
- ✅ 测试下拉刷新

### 2. 搜索和筛选测试
- ✅ 客户搜索（搜索"重要客户001"）
- ✅ 产品搜索（搜索"经典圆领T恤"）
- ✅ 状态筛选（待处理/已完成/已退货）
- ✅ 日期筛选（本周/本月/自定义）

### 3. 分页性能测试
- ✅ 向下滚动触发分页加载
- ✅ 验证加载指示器
- ✅ 测试到达底部的提示
- ✅ 验证缓存机制

### 4. 月份分布验证
验证每个月的数据分布是否正确：
- 1月：1500条
- 2月：800条  
- 3月：2200条
- 4月：2500条
- 5月：2800条
- 6月：3200条
- 7月：3500条
- 8月：3500条

## 📈 性能指标

### 预期性能表现
- **首次加载**: < 2秒
- **分页加载**: < 1秒
- **搜索响应**: < 500ms
- **筛选响应**: < 300ms

### 内存使用
- **峰值内存**: ~300MB
- **稳定运行**: ~150MB
- **无内存泄漏**: 连续使用30分钟

## 🔧 故障排除

### 数据未生成
1. 检查环境变量设置是否正确
2. 确认是DEBUG模式运行
3. 查看控制台是否有错误信息
4. 重新Clean Build项目

### 性能问题
1. 使用真机测试（推荐）
2. 关闭其他占用内存的应用
3. 重启模拟器
4. 检查Xcode版本兼容性

### 应用崩溃
1. 查看崩溃日志
2. 检查SwiftData配置
3. 验证Model定义
4. 降低数据生成量（修改常量）

## 🗑️ 数据清理

### 开发阶段清理
```swift
// 在代码中调用清理方法
let sampleDataService = CustomerOutOfStockSampleDataService(repositoryFactory: repositoryFactory)
await sampleDataService.clearAllSampleData()
```

### 上线前彻底清理
1. 删除 `Lopan/Services/SampleData/` 整个目录
2. 在 `LopanApp.swift` 中移除大规模数据生成相关代码
3. 移除环境变量设置
4. Clean Build确保无残留

## 📊 数据特征说明

### 客户特征
- **命名规则**: "重要客户001" - "普通客户200"
- **地址分布**: 20个主要城市
- **电话号码**: 真实格式的随机号码

### 产品特征
- **命名规则**: 带修饰词的产品名（新款时尚T恤等）
- **颜色配置**: 每个产品3-5种颜色
- **尺码配置**: 每个产品3-6个尺码

### 欠货记录特征
- **状态分布**: 待处理40%，已完成50%，已退货10%
- **数量分布**: 小批量30%，中批量40%，大批量20%，超大批量10%
- **时间分布**: 符合季节性业务规律
- **备注内容**: 真实业务场景的备注

## ✅ 验收标准

### 功能完整性
- [ ] 所有500个客户正确生成
- [ ] 所有300个产品正确生成  
- [ ] 所有20000条记录正确生成
- [ ] 数据关联关系正确

### 性能标准
- [ ] 生成时间< 5分钟
- [ ] 列表加载< 2秒
- [ ] 搜索响应< 500ms
- [ ] 内存使用< 400MB

### 用户体验
- [ ] 操作流畅无卡顿
- [ ] 加载状态清晰
- [ ] 错误处理完善
- [ ] 数据展示美观

## 📞 技术支持

如遇问题，请提供以下信息：
1. 环境变量设置截图
2. 控制台完整日志
3. 具体操作步骤
4. 期望结果vs实际结果

---

**注意**: 此功能仅用于开发和测试阶段，上线前务必完全移除。