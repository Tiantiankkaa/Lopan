# 大规模样本数据生成系统

## 概述

本系统为客户缺货管理功能提供大规模测试数据，用于功能测试和性能验证。

## 数据规模

- **客户数量**: 500个
- **产品数量**: 300个
- **欠货记录**: 20000条
- **时间范围**: 2025年1月1日至8月20日

## 使用方法

### 1. 启用大规模数据生成

通过环境变量控制是否生成大规模数据：

```bash
# 在Xcode中设置环境变量
LARGE_SAMPLE_DATA=true
```

或者在Scheme编辑器中：
1. Product → Scheme → Edit Scheme
2. Run → Arguments → Environment Variables
3. 添加 `LARGE_SAMPLE_DATA = true`

### 2. 运行应用

启动应用后，系统会自动检测环境变量并开始生成大规模数据。

### 3. 监控进度

应用会在控制台输出详细的进度信息，包括：
- 当前阶段
- 完成进度
- 用时统计
- 预估剩余时间

## 数据分布

### 客户分布
- **重要客户**: 100个
- **标准客户**: 200个
- **普通客户**: 200个

### 产品分布
- **上衣类**: 100个
- **裤装类**: 80个
- **裙装类**: 60个
- **鞋类**: 40个
- **配饰类**: 20个

### 欠货记录月份分布
- **1月**: 1500条（春节前备货）
- **2月**: 800条（春节期间较少）
- **3月**: 2200条（春季新品）
- **4月**: 2500条（换季高峰）
- **5月**: 2800条（夏季开始）
- **6月**: 3200条（618促销）
- **7月**: 3500条（暑期高峰）
- **8月**: 3500条（持续高峰，截至20日）

### 状态分布
- **待处理**: 40% (8000条)
- **已完成**: 50% (10000条)
- **已退货**: 10% (2000条)

## 文件结构

```
SampleData/
├── README.md                              # 本文档
├── SampleDataConstants.swift              # 常量配置
├── LargeSampleDataGenerator.swift         # 数据生成工具
├── CustomerOutOfStockSampleDataService.swift  # 主服务类
└── SampleDataProgressMonitor.swift        # 进度监控
```

## 性能预期

### 生成时间
- **客户数据**: ~15秒
- **产品数据**: ~10秒
- **欠货记录**: ~2-3分钟
- **总计**: ~3-4分钟

### 内存使用
- 批量处理机制，每批500条记录
- 内存峰值约200-300MB
- 自动内存管理，无泄漏风险

## 清理数据

### 开发阶段清理
```swift
let sampleDataService = CustomerOutOfStockSampleDataService(repositoryFactory: repositoryFactory)
await sampleDataService.clearAllSampleData()
```

### 上线前清理
1. 删除整个 `SampleData` 目录
2. 从 `LopanApp.swift` 中移除相关代码
3. 删除环境变量设置

## 使用场景

### 功能测试
- 测试分页加载性能
- 验证搜索和筛选功能
- 测试不同状态下的UI表现
- 验证日期范围筛选

### 性能测试
- 大数据量下的列表滚动性能
- 数据库查询性能
- 内存使用情况
- 启动时间影响

### 用户体验测试
- 长列表用户体验
- 搜索响应速度
- 筛选交互体验

## 注意事项

### 开发环境
- 仅在DEBUG模式下生效
- 通过环境变量控制启用
- 自动检测现有数据量，避免重复生成

### 生产环境
- 自动跳过数据生成
- 不会影响真实数据
- 安全可靠

### 数据特征
- 所有数据都是模拟生成
- 符合真实业务场景
- 包含各种边界情况
- 时间分布符合季节性规律

## 故障排除

### 生成失败
1. 检查环境变量设置
2. 确认DEBUG模式
3. 查看控制台错误信息
4. 检查磁盘空间是否充足

### 性能问题
1. 确认设备性能（建议真机测试）
2. 关闭其他应用释放内存
3. 检查网络连接（如果涉及）

### 数据异常
1. 使用清理功能重新生成
2. 检查SwiftData配置
3. 验证Model定义

## 联系支持

如果遇到问题或需要自定义数据规模，请联系开发团队。